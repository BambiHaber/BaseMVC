!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.BaseMVC={})}(this,function(t){"use strict";function e(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}var s,i=(function(t,s){t.exports=function t(s,i,o){function r(l,h){if(!i[l]){if(!s[l]){var a=e;if(!h&&a)return a(l,!0);if(n)return n(l,!0);var u=new Error("Cannot find module '"+l+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[l]={exports:{}};s[l][0].call(c.exports,function(t){var e=s[l][1][t];return r(e||t)},c,c.exports,t,s,i,o)}return i[l].exports}for(var n=e,l=0;l<o.length;l++)r(o[l]);return r}({1:[function(t,e,s){var i=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),o={emitDelay:10,strictMode:!1},r=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?o:arguments[0];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var s=void 0,i=void 0;s=e.hasOwnProperty("emitDelay")?e.emitDelay:o.emitDelay,this._emitDelay=s,i=e.hasOwnProperty("strictMode")?e.strictMode:o.strictMode,this._strictMode=i,this._listeners={},this.events=[]}return i(t,[{key:"_addListenner",value:function(t,e,s){if("function"!=typeof e)throw TypeError("listener must be a function");-1===this.events.indexOf(t)?(this._listeners[t]=[{once:s,fn:e}],this.events.push(t)):this._listeners[t].push({once:s,fn:e})}},{key:"on",value:function(t,e){this._addListenner(t,e,!1)}},{key:"once",value:function(t,e){this._addListenner(t,e,!0)}},{key:"off",value:function(t,e){var s,i,o=this,r=this.events.indexOf(t),n=t&&-1!==r;n&&(e?(s=[],(i=o._listeners[t]).forEach(function(t,i){t.fn===e&&s.unshift(i)}),s.forEach(function(t){i.splice(t,1)}),i.length||(o.events.splice(r,1),delete o._listeners[t])):(delete this._listeners[t],this.events.splice(r,1)))}},{key:"_applyEvents",value:function(t,e){var s=this._listeners[t];if(s&&s.length){var i=[];s.forEach(function(t,s){t.fn.apply(null,e),t.once&&i.unshift(s)}),i.forEach(function(t){s.splice(t,1)})}else if(this._strictMode)throw"No listeners specified for event: "+t}},{key:"emit",value:function(t){for(var e=this,s=arguments.length,i=Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];this._emitDelay?setTimeout(function(){e._applyEvents.call(e,t,i)},this._emitDelay):this._applyEvents(t,i)}},{key:"emitSync",value:function(t){for(var e=arguments.length,s=Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];this._applyEvents(t,s)}},{key:"destroy",value:function(){this._listeners={},this.events=[]}}]),t}();e.exports=r},{}]},{},[1])(1)}(s={exports:{}},s.exports),s.exports);class o{static size(t){let e=0;return null!==t&&(e=Array.isArray(t)?t.length:Object.keys(t).length),e}static isFunction(t){return!!(t&&t.constructor&&t.call&&t.apply)}static first(){}}class r{static _newRegex(t="(<%=?(.*)?%>)",e="gm"){return new RegExp(t,e)}static compile(t=""){let e,s=this._newRegex(),i=t.length,o=[],r=0,n=[];for(;null!==(e=s.exec(t));)o.push({portion:t.substring(r,e.index),cursor:r,result:e[0],strippedResult:e[2],next:s.lastIndex}),r=s.lastIndex;return null===e&&o.push({portion:t.substring(o[o.length-1]&&o[o.length-1].next||0,i)}),n.push("var str = '';\n"),o.forEach(t=>{t.portion&&(n+="str = str + `"+t.portion+"`;\n"),t.result&&("="===t.result[2]?n+="str = str + "+t.strippedResult+";\n":n+=t.strippedResult+"\n")}),n+="\nreturn str;",new Function(n)}static render(t,e={}){return this.compile(t).bind(e)()}}t.SwissKnife=o,t.Template=r,t.BaseModel=class{constructor(t,e={}){this.options=e,this.defaults=e.defaults||{},this.disableAttributesExtension=this.options.disableAttributesExtension,this.noExceptions=this.options.noExceptions,this._allowOnlyAuthorizedKeys=this.disableAttributesExtension&&this.hasDefaults(),this.attributes=this.hasDefaults()?this.getDefaults():{},t&&Object.keys(t).forEach(e=>{this.set(e,t[e])})}hasDefaults(){return this.constructor.defaults&&"object"==typeof this.constructor.defaults}getDefaults(){return this.constructor.defaults}set(t,e){if(this._allowOnlyAuthorizedKeys){var s=this.getDefaults(),i=Object.keys(s);if("object"==typeof t&&void 0===e);else if(i.includes(t))console.log(this.attributes),this._set(t,e);else if(!this.noExceptions)throw"Allow only authorized keys is enabled. "}else this._set(t,e)}_set(t,e){"object"!=typeof t||Array.isArray(t)||void 0!==e?this.attributes[t]=e:Object.keys(t).forEach(e=>{this.attributes[e]=t[e]})}get(t){return this.attributes[t]}toJSON(){return this.attributes}},t.BaseCollection=class extends i{constructor(t,e){super(),this.options=e||{},this.url=this.options.url,this.modelOptions=this.options.modelOptions,this.modelClass=this.constructor.model||this.options.model,this.models=[],t&&Array.isArray(t)&&o.size(t)>0&&this.reset(t),this.comparator=e&&e.comparator}get rawData(){return this._data}set rawData(t){this._data=t}add(t={},e=!1){if(this.modelClass){let s,i=e?"unshift":"push";return s=this.modelOptions?new this.modelClass(t,this.modelOptions):new this.modelClass(t),this.models[i](s),this.emit("add:end",s),this}throw"NO_MODEL_CLASS_DEFINED_FOR_COLLECTION"}remove(t){this.models}find(t){let e=this.toJSON().find(t);return this.emit("find",e),e}where(t){let e=this.toJSON().filter(t);return this.emit("where",e),e}filter(t){let e=this.where(t);return this.emit("filter",e),e}get modelType(){return this.modelClass&&this.modelClass.constructor&&this.modelClass.constructor.name||"Object"}reset(t){if(this.models.length=0,this.emit("reset",t),this.modelClass)return t.forEach(t=>{this.modelOptions?this.models.push(new this.modelClass(t,this.modelOptions)):this.models.push(new this.modelClass(t))}),this.emit("reset:end",this.models),this;throw"NO_MODEL_CLASS_DEFINED_FOR_COLLECTION"}toJSON(){let t=[];return this.models.forEach(e=>{t.push(e&&e.toJSON())}),this.comparator&&(t=t.sort(this.comparator)),t}forEach(t){let e=this.models;this.comparator&&(e=o.isFunction(this.comparator)?e.sort(t=>this.comparator(t.toJSON())):e.sort(t=>t.toJSON()[this.comparator])),e.forEach(function(e){t(e)})}get size(){return this.models.length}},t.BaseView=class extends i{constructor(t={}){super(),this.options=t,this.model=this.options.model?this.options.model:null,this.template=this.options.template?this.options.template:null,this.el=this.options.el||document.querySelector("body")}get model(){return this._model}set model(t){this._model=t}get template(){return this._template}set template(t){this._template=t}render(t){t||(t=this.model.toJSON?this.model.toJSON():this.model);let e=r.render(this.template||this.constructor.template,t);this.el.innerHTML=e}},Object.defineProperty(t,"__esModule",{value:!0})});
